<!-- lcg-generator.component.html -->
<div class="container mx-auto p-4 max-w-6xl">
  <h2 class="text-2xl font-bold mb-4 text-center">Generador Congruencial Lineal (LCG)</h2>
  <p class="text-sm text-gray-600 mb-2 text-center">Fórmula: Xₖ₊₁ = (a × Xₖ + c) mod m, donde m = 2^g</p>

  <form [formGroup]="form" (ngSubmit)="generate()" class="bg-gray-50 p-4 rounded-lg shadow-md">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4">
      <div>
        <label class="block font-semibold mb-1">g (exponente):</label>
        <input formControlName="g" type="number" class="border p-2 rounded w-full" placeholder="Ej: 8">
      </div>
      <div>
        <label class="block font-semibold mb-1">a (multiplicador):</label>
        <input formControlName="a" type="number" class="border p-2 rounded w-full" placeholder="Ej: 137">
      </div>
      <div>
        <label class="block font-semibold mb-1">c (constante):</label>
        <input formControlName="c" type="number" class="border p-2 rounded w-full" placeholder="Ej: 0">
      </div>
      <div>
        <label class="block font-semibold mb-1">X₀ (semilla inicial):</label>
        <input formControlName="X0" type="number" class="border p-2 rounded w-full" placeholder="Ej: 1">
      </div>
      <div>
        <label class="block font-semibold mb-1">N (iteraciones):</label>
        <input formControlName="N" type="number" class="border p-2 rounded w-full" placeholder="Auto">
      </div>
    </div>

    <div class="flex gap-2 justify-center">
      <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded font-semibold transition">
        Generar
      </button>
      <button type="button" (click)="reset()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded font-semibold transition">
        Reiniciar
      </button>
    </div>
  </form>

  <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mt-4">
    <strong>Error:</strong> {{ errorMessage }}
  </div>

  <div *ngIf="results.length > 0" class="mt-6">
    <!-- Parámetros y ciclo -->
    <div class="bg-blue-50 p-4 rounded-lg mb-4">
      <h3 class="font-bold text-lg mb-2">Parámetros del Generador</h3>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
        <div><strong>g:</strong> {{ g }}</div>
        <div><strong>m:</strong> {{ m }} (2^{{ g }})</div>
        <div><strong>a:</strong> {{ a }}</div>
        <div><strong>c:</strong> {{ c }}</div>
        <div><strong>X₀:</strong> {{ X0 }}</div>
        <div><strong>N:</strong> {{ N }}</div>
      </div>
      <div *ngIf="cycleDetected" class="mt-3 text-orange-700 font-semibold">
        ⚠️ Ciclo detectado: Longitud del ciclo = {{ cycleLength }}
      </div>
      <div *ngIf="!cycleDetected && results.length > 0" class="mt-3 text-green-700 font-semibold">
        ✓ No se detectó ciclo en las {{ results.length }} iteraciones
      </div>
    </div>
    
    <!-- Scatter Chart -->
    <div class="bg-white p-4 rounded-lg shadow-lg mb-6" style="min-height: 400px;">
      <canvas #scatterChart style="width: 100%; height: 400px;"></canvas>
    </div>

    <!-- Results table -->
    <div class="bg-white p-4 rounded-lg shadow-md">
      <h3 class="font-bold text-lg mb-3">Valores Generados</h3>
      <div class="overflow-x-auto max-h-96 overflow-y-auto">
        <table class="w-full border-collapse">
          <thead class="bg-gray-100 sticky top-0">
            <tr>
              <th class="border px-4 py-2">Índice (k)</th>
              <th class="border px-4 py-2">Valor (Xₖ)</th>
              <th class="border px-4 py-2">Normalizado (uₖ = Xₖ / m)</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let r of results" class="hover:bg-gray-50">
              <td class="border px-4 py-2 text-center">{{ r.index }}</td>
              <td class="border px-4 py-2 text-center">{{ r.value }}</td>
              <td class="border px-4 py-2 text-center">{{ r.normalized.toFixed(6) }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
